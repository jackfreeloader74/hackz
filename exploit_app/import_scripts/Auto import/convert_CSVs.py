import pandas as pd
import numpy

####################################################
#create stages list

col_list = ['ProgramID', 'Stage']
stage = pd.read_csv('ProgStgMap.csv', usecols=col_list)
array = numpy.array(pd.unique(stage['Stage']),dtype=object)
numpy.savetxt('Stages.csv', array, delimiter=' ', fmt='%s')

####################################################
#create tag list

col_list = ['CmdID', 'Tag']
stage = pd.read_csv('CmdTagMap.csv', usecols=col_list)
array = numpy.array(pd.unique(stage['Tag']),dtype=object)
numpy.savetxt('Tags.csv', array, delimiter=' ', fmt='%s')

####################################################
#method type

col_list = ['MethodID', 'Method', 'Description', 'Type', 'Asscociated Programs', 'Ref']
stage = pd.read_csv('Method.csv', usecols=col_list)
array = numpy.array(pd.unique(stage['Type']),dtype=object)
numpy.savetxt('Method_Types.csv', array, delimiter=' ', fmt='%s')


####################################################
#import program refernces
unq_array = []

col_list = ['ProgramID', 'Reference']
panda_array = pd.read_csv('ProgRefMap.csv', usecols=col_list)
unq_array = pd.unique(panda_array['Reference'])
df = pd.DataFrame({'Ref': unq_array})
df = df.astype({'Ref': object})
df.to_csv('References.csv', header='Ref', index=False)

#import command references

col_list = ['CmdID', 'Ref']
panda_array = pd.read_csv('CmdRefMap.csv', usecols=col_list)
unq_array = pd.unique(panda_array['Ref'])
df = pd.DataFrame({'Ref': unq_array})
df = df.astype({'Ref': object})
df.to_csv('References.csv', mode='a', header=False, index=False)

#import attack references

col_list = ['AttackID', 'Reference']
panda_array = pd.read_csv('AttkRefMap.csv', usecols=col_list)
unq_array = pd.unique(panda_array['Reference'])
df = pd.DataFrame({'Ref': unq_array})
df = df.astype({'Ref': object})
df.to_csv('References.csv', mode='a', header=False, index=False)

#import attack references

col_list = ['MethodID', 'Method', 'Description', 'Type', 'Asscociated Programs', 'Ref']
panda_array = pd.read_csv('Method.csv', usecols=col_list)
unq_array = pd.unique(panda_array['Ref'])
df = pd.DataFrame({'Ref': unq_array})
df = df.astype({'Ref': object})
df.to_csv('References.csv', mode='a', header=False, index=False)
